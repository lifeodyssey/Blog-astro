---
import { allLocales } from '@/config'
import { getLangFromLocale, getLangRouteParam } from '@/i18n/lang'
import { ui } from '@/i18n/ui'
import Layout from '@/layouts/Layout.astro'

export async function getStaticPaths() {
  return allLocales.map(lang => ({
    params: { lang: getLangRouteParam(lang) },
  }))
}

const currentLang = getLangFromLocale(Astro.currentLocale)
const currentUI = ui[currentLang as keyof typeof ui] ?? {}
---

<Layout>
  <!-- Decorative Line -->
  <div class="uno-decorative-line" />
  <!-- Search -->
  <div class="search-container">
    <h1 class="text-4.5 c-primary font-bold mb-6">{currentUI.search}</h1>
    <div id="search"></div>
  </div>
</Layout>

<link href="/pagefind/pagefind-ui.css" rel="stylesheet" />
<script is:inline src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
<script is:inline>
  window.addEventListener('DOMContentLoaded', () => {
    new PagefindUI({
      element: '#search',
      showImages: false,
      showSubResults: true
    });
  });
</script>

<style is:global>
  .pagefind-ui {
    --pagefind-ui-scale: 0.9;
    --pagefind-ui-primary: var(--c-primary);
    --pagefind-ui-text: var(--c-text);
    --pagefind-ui-background: var(--c-bg);
    --pagefind-ui-border: var(--c-secondary);
    --pagefind-ui-border-width: 1px;
    --pagefind-ui-border-radius: 4px;
    --pagefind-ui-font: inherit;
  }

  .pagefind-ui__search-input {
    font-size: 1rem !important;
    padding: 0.75rem 1rem !important;
  }

  .pagefind-ui__result-link {
    color: var(--c-primary) !important;
    font-weight: 600 !important;
  }

  .pagefind-ui__result-excerpt {
    color: var(--c-text) !important;
    opacity: 0.8;
  }
</style>
