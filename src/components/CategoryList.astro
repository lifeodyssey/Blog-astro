---
import type { Language } from '@/i18n/config'
import type { UserCategoryWithCount } from '@/utils/content'
import { ui } from '@/i18n/ui'

interface Props {
  categories: UserCategoryWithCount[]
  currentCategory?: string
  lang: Language
}

const { categories, currentCategory = '', lang } = Astro.props
const currentUI = ui[lang as keyof typeof ui] ?? {}
const postsText = currentUI.posts || 'posts'

// Generate category path (user-defined categories)
function getCategoryPagePath(category: string): string {
  const langPrefix = lang === 'zh' ? '' : `/${lang}`
  return `${langPrefix}/categories/${encodeURIComponent(category)}`
}
---

<ul class="category-list no-heti">
  {categories.map(cat => {
    const isActive = currentCategory === cat.name
    return (
      <li class="category-item">
        <a
          href={getCategoryPagePath(cat.name)}
          class:list={[
            'category-link',
            isActive && 'active',
          ]}
        >
          <span class="category-name">{cat.name}</span>
          <span class="category-count">({cat.count})</span>
        </a>
      </li>
    )
  })}
</ul>

<style>
.category-list {
  --at-apply: 'list-none p-0 m-0';
}

.category-item {
  --at-apply: 'py-1.5';
}

.category-link {
  --at-apply: 'inline-flex items-center gap-2';
  --at-apply: 'c-secondary/80 transition-colors';
  --at-apply: 'hover:c-primary';
}

.category-link.active {
  --at-apply: 'c-primary font-semibold';
}

.category-name {
  --at-apply: 'text-4';
}

.category-count {
  --at-apply: 'text-3.5 c-secondary/60';
}
</style>
